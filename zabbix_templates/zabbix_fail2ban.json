{
  "_template_info": {
    "purpose": "Provides comprehensive monitoring capabilities for fail2ban intrusion prevention service with process monitoring, jail discovery, and version tracking",
    "context": "Designed for use with container environments where fail2ban is deployed for security monitoring and IP blocking",
    "note": "This template includes both basic service monitoring and dynamic jail discovery for comprehensive fail2ban oversight"
  },
  "zabbix_export": {
    "version": "6.2",
    "date": "2024-01-02T17:17:20Z",
    
    "_section_info": {
      "template_groups": "Defines logical grouping for fail2ban templates and applications",
      "templates": "Contains the main fail2ban monitoring template with items, discovery rules, and triggers",
      "items": "Core monitoring metrics for fail2ban service health and version",
      "discovery_rules": "Dynamic discovery of fail2ban jails for comprehensive monitoring",
      "valuemaps": "Human-readable value mappings for service states"
    },
    
    "template_groups": [
      {
        "uuid": "a571c0d144b14fd4a87a9d9b2aa9fcd6",
        "name": "Templates/Applications"
      }
    ],
    
    "templates": [
      {
        "_template_section": "FAIL2BAN MONITORING TEMPLATE - Comprehensive monitoring for intrusion prevention service",
        "uuid": "48d19098672f4e7aa7dab1942260d87d",
        "template": "Fail2Ban",
        "name": "Fail2Ban",
        "groups": [
          {
            "name": "Templates/Applications"
          }
        ],
        
        "_items_section": "FAIL2BAN MONITORING ITEMS - Core metrics for service health and version tracking",
        "items": [
          {
            "_item_info": "FAIL2BAN VERSION MONITORING - Tracks fail2ban version changes for security updates",
            "uuid": "f47a5d9d3e4949989ef6b6514e04a035",
            "name": "Fail2Ban: Version",
            "type": "ZABBIX_ACTIVE",
            "key": "fail2ban.version",
            "delay": "60m",
            "history": "7d",
            "trends": "0",
            "value_type": "CHAR",
            "tags": [
              {
                "tag": "Application",
                "value": "Fail2Ban"
              }
            ],
            "triggers": [
              {
                "_trigger_info": "VERSION CHANGE ALERT - Notifies when fail2ban version changes",
                "uuid": "7bc5287a76c045f79bd0921261943f38",
                "expression": "last(/Fail2Ban/fail2ban.version,#1)<>last(/Fail2Ban/fail2ban.version,#2) \nand length(last(/Fail2Ban/fail2ban.version))>0",
                "name": "Fail2Ban: Version has changed (new version: { ITEM.VALUE })",
                "priority": "INFO"
              }
            ]
          },
          {
            "_item_info": "FAIL2BAN PROCESS MONITORING - Tests if fail2ban server is running and responsive",
            "uuid": "de416c540fd0435db1822e38c036f0d7",
            "name": "Fail2Ban: Processes",
            "type": "ZABBIX_ACTIVE",
            "key": "proc.num[fail2ban-server]",
            "history": "7d",
            "description": "Tests if the server is alive",
            "valuemap": {
              "name": "Service state"
            },
            "tags": [
              {
                "tag": "Application",
                "value": "Fail2Ban"
              }
            ],
            "triggers": [
              {
                "_trigger_info": "PROCESS FAILURE ALERT - Notifies when fail2ban process stops running",
                "uuid": "ffa07343b51d4bf58c2b8c324c6a7a62",
                "expression": "sum(/Fail2Ban/proc.num[fail2ban-server],#3)=0",
                "name": "Fail2ban: Process is not running",
                "priority": "AVERAGE"
              }
            ]
          }
        ],
        
        "_discovery_section": "FAIL2BAN JAIL DISCOVERY - Dynamic discovery of configured fail2ban jails",
        "discovery_rules": [
          {
            "_discovery_info": "JAIL DISCOVERY RULE - Automatically discovers all configured fail2ban jails",
            "uuid": "ccbd8ba7a96d47b8953af017e3b0f803",
            "name": "Fail2ban: Jail Discovery",
            "type": "ZABBIX_ACTIVE",
            "key": "fail2ban.discovery",
            "description": "Discovery of jails from fail2ban daemon.",
            
            "_item_prototypes_section": "JAIL MONITORING ITEMS - Individual metrics for each discovered jail",
            "item_prototypes": [
              {
                "_prototype_info": "JAIL BANNED IP COUNT - Tracks number of banned IPs for each jail",
                "uuid": "8cc0b05211fc4278b2feb46727a4ca97",
                "name": "Fail2Ban: $1 banned IPs",
                "type": "ZABBIX_ACTIVE",
                "key": "fail2ban.status.[{#JAIL}]",
                "delay": "5m",
                "history": "7d",
                "units": "count",
                "tags": [
                  {
                    "tag": "Application",
                    "value": "Fail2Ban"
                  }
                ]
              }
            ],
            
            "_graph_prototypes_section": "JAIL VISUALIZATION - Graphical representation of banned IP counts",
            "graph_prototypes": [
              {
                "_graph_info": "JAIL BANNED IP GRAPH - Visual chart showing banned IP trends per jail",
                "uuid": "b151e34af81548b1b92cf0a6b36cdee7",
                "name": "Fail2Ban: Count of banned IPs on jail {#JAIL}",
                "graph_items": [
                  {
                    "sortorder": "1",
                    "color": "00C800",
                    "item": {
                      "host": "Fail2Ban",
                      "key": "fail2ban.status.[{#JAIL}]"
                    }
                  }
                ]
              }
            ]
          }
        ],
        
        "_tags_section": "TEMPLATE CLASSIFICATION - Service categorization and deployment type",
        "tags": [
          {
            "tag": "Service",
            "value": "Baremetal"
          },
          {
            "tag": "Service",
            "value": "Log Analysis"
          }
        ],
        
        "_valuemaps_section": "VALUE MAPPINGS - Human-readable translations for numeric status codes",
        "valuemaps": [
          {
            "_valuemap_info": "SERVICE STATE MAPPING - Converts numeric service states to readable values",
            "uuid": "249132609d114d21bf84a38a3c559bfd",
            "name": "Service state",
            "mappings": [
              {
                "value": "0",
                "newvalue": "Down"
              },
              {
                "value": "1",
                "newvalue": "Up"
              }
            ]
          }
        ]
      }
    ]
  }
}
